import{l as h,ad as y,r as g,A as w,c as f,a as l,b as v,d as b,j as k,o as _,_ as C,v as x}from"./index-dPwBrLZS.js";const V=h({name:"ConditionalWrapper",inheritAttrs:!1,props:{tag:{type:String,default:"div"},skip:{type:Boolean,required:!0}},slots:Object,setup(t,{slots:r,attrs:n}){return()=>t.skip?r.default?.({}):y(t.tag,{...n},[r.default?.({})])}}),I={class:"image-uploader"},P=["disabled"],R={class:"d-flex align-items-center gap-2"},S={key:0,class:"image-preview position-relative"},T=["src"],U={class:"image-actions position-absolute m-0 d-flex gap-1"},B=["disabled"],$=["disabled"],j={key:1,class:"d-flex gap-2 align-items-center no-preview"},z=["disabled"],N=h({__name:"ImageUploader",props:{initialPreview:{},disabled:{type:Boolean}},emits:["update:file","update:preview"],setup(t,{emit:r}){const n=t,i=r,d=g(null),s=g(n.initialPreview??null);w(()=>n.initialPreview,e=>{s.value=e??null});function u(){d.value?.click()}function m(e){const o=e.target.files?.[0]||null;if(i("update:file",o),o){const c=URL.createObjectURL(o);s.value=c,i("update:preview",c)}else s.value=null,i("update:preview",null)}function p(){d.value&&(d.value.value=""),i("update:file",null),s.value=null,i("update:preview",null)}return(e,a)=>{const o=b("IconUpload"),c=b("IconTrash");return _(),f("div",I,[l("input",{ref_key:"inputRef",ref:d,type:"file",accept:"image/*",class:"d-none",onChange:m,disabled:t.disabled},null,40,P),l("div",R,[s.value?(_(),f("div",S,[l("img",{src:s.value,alt:"Preview",class:"preview-image"},null,8,T),l("div",U,[l("button",{type:"button",class:"btn btn-outline-primary p-1",onClick:u,disabled:t.disabled},[v(o,{size:16})],8,B),l("button",{type:"button",class:"btn btn-outline-danger p-1",onClick:p,disabled:t.disabled},[v(c,{size:16})],8,$)])])):(_(),f("div",j,[l("button",{type:"button",class:"btn btn-outline-primary p-1",onClick:u,disabled:t.disabled},[a[0]||(a[0]=k(" Click Para Subir Imagen ",-1)),v(o,{size:16,class:"ml-1"})],8,z)]))])])}}}),A=C(N,[["__scopeId","data-v-89a33535"]]);async function D(t,r="announcements"){try{const i=(await x.getSignature(r)).data,{signature:d,timestamp:s,api_key:u,cloud_name:m,folder:p}=i,e=new FormData;e.append("file",t),e.append("api_key",u),e.append("timestamp",String(s)),e.append("signature",d),p&&e.append("folder",p);const a=await fetch(`https://api.cloudinary.com/v1_1/${m}/image/upload`,{method:"POST",body:e});if(!a.ok){const c=await a.text().catch(()=>"");throw new Error(`Cloudinary upload failed: ${a.status} ${a.statusText} ${c}`)}return(await a.json()).secure_url}catch(n){throw console.error("Cloudinary upload error:",n),n}}export{A as I,V as _,D as u};
